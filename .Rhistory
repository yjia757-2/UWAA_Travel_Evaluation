}
CalVeryGood <-function (x){
data <-x
str_count(data,"Very Good")
}
CalExcellent <-function (x){
data <-x
str_count(data,"Excellent")
}
CalFair <-function (x){
data <-x
str_count(data,"Fair")
}
CalPoor <-function (x){
data <-x
str_count(data,"Poor")
}
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
mutate("Total"=rowSums(datasum.name[,c(2:6)]))
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
mutate("Total"=rowSums(c(2:6)))
datasum.operator <- datasummary2017 %>%
group_by(tour_operator) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
select("tour_operator","excellent","very_good","good","fair","poor")
View(datasum.operator)
datasum.operator[,"Total"] <-rowSums(datasum.name[,c(2:6)])
datasum.operator[,"Total"] <-rowSums(datasum.operator[,c(2:6)])
View(datasum.operator)
datasum.name %>% group_by(Total) %>% summarise(sumeval=sum(Total))
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"Total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name %>% group_by(Total) %>% summarise(sumeval=sum(Total))
b<- datasum.name %>% group_by(Total) %>% summarise(sumeval=sum(Total))
View(b)
unique(datasum.name$tour_name)
b<- datasum.name %>% group_by(tour_name) %>% summarise(sumeval=sum(Total))
View(b)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(Total))
View(datasum.name)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(Total),"Excellent"=sum(Excellent))
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(Total),"Excellent"=sum(excellent))
View(b)
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent),
"VeryGood"=sum(very_good),
"good"=sum(good),
"fair"=sum(fair),
"poor"=sum(poor))
View(b)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good),
"good"=sum(good),
"fair"=sum(fair),
"poor"=sum(poor))
View(b)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent),
"VeryGood"=sum(very_good),
"good"=sum(good),
"fair"=sum(fair),
"poor"=sum(poor))
View(b)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
View(b)
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=paste(round(sum(excellent)/Total,"%",sep="")),
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=paste(round((sum(excellent)/Total),"%",sep="")),
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=paste(round(((sum(excellent))/Total),"%",sep="")),
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total) %>%
select(Total=paste(round(Total),"%",sep="")
-paste(round(as.numeric(group.eval[group.eval[,1]=="Excellent",2])/total.number,4)*100, "%", sep="")
datasum.operator <- datasummary2017 %>%
group_by(tour_operator) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
select("tour_operator","excellent","very_good","good","fair","poor")
datasum.operator[,"Total"] <-rowSums(datasum.operator[,c(2:6)])
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total) %>%
select(Total=paste(round(Total),"%",sep=""))
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total) %>%
datasum.name$Total <-paste(round(Total),"%",sep=""))
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total) %>%
datasum.name$Total <-paste(round(Total),"%",sep="")
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name$Total <-paste(round(Total),"%",sep="")
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(Total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(Total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
View(datasum.name)
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(Total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
View(datasum.name)
b<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name
datasum.name$Excellent <-paste(round(Excellent,2),"%",sep="")
datasum.name$Excellent <-paste(round(datasum.name$Excellent,2),"%",sep="")
View(datasum.name)
datasum.name$Excellent <-paste(round(datasum.name$Excellent*100,2),"%",sep="")
datasum.name$Excellent <-paste(round(datasum.name$Excellent,2),"%",sep="")
datasum.name$Excellent <-paste(round(datasumnameExcellent,2),"%",sep="")
datasum.name$Excellent <-paste(round(datasumname$Excellent,2),"%",sep="")
datasum.name$Excellent <-paste(round(datasum.name$Excellent,2),"%",sep="")
datasum.name$Excellent <-paste(round(datasum.name$Excellent),"%",sep="")
datasum.name$Excellent <-paste(round(datasum.name$Excellent,2),"%")
colnames(datasum.name$Excellent) <-paste(round(datasum.name$Excellent,2),"%",sep="")
View(datasum.name)
round(datasum.name$Excellent,2)
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
library(dplyr)
library(ggplot2)
library(data.table)
library(stringr)
datasummary2017 <-read.csv("data/data2017_jan_oct.csv",stringsAsFactors = FALSE)
CalGood <-function (x){
data <-x
str_count(data,"Good")
}
CalVeryGood <-function (x){
data <-x
str_count(data,"Very Good")
}
CalExcellent <-function (x){
data <-x
str_count(data,"Excellent")
}
CalFair <-function (x){
data <-x
str_count(data,"Fair")
}
CalPoor <-function (x){
data <-x
str_count(data,"Poor")
}
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name$Excellent <-paste(round(datasum.name$Excellent,2),"%",sep="")
View(datasum.name)
datasum.name$Excellent <-paste(round(datasum.name$Excellent*100,2),"%",sep="")
library(dplyr)
library(ggplot2)
library(data.table)
library(stringr)
datasummary2017 <-read.csv("data/data2017_jan_oct.csv",stringsAsFactors = FALSE)
# I got the summary of how much percentage of each evaluation.
Group.Evaluation <-function (x) {
col_name <- as.name(colnames(datasummary2017 %>% select(x)))
group.eval <-datasummary2017 %>%
group_by_(col_name) %>%
summarise(n=n())
group.eval <-group.eval[complete.cases(group.eval), ]
total.number <-sum(group.eval$n)
pect.excellent <-paste(round(as.numeric(group.eval[group.eval[,1]=="Excellent",2])/total.number,4)*100, "%", sep="")
pect.good <-paste(round(as.numeric(group.eval[group.eval[,1]=="Good",2])/total.number,4)*100, "%", sep="")
pect.verygood <-paste(round(as.numeric(group.eval[group.eval[,1]=="Very Good",2])/total.number,4)*100, "%", sep="")
pect.fair <-paste(round(as.numeric(group.eval[group.eval[,1]=="Fair",2])/total.number,4)*100, "%", sep="")
pect.poor <-paste(round(as.numeric(group.eval[group.eval[,1]=="Poor",2])/total.number,4)*100, "%", sep="")
eval.data <- data.frame(
Excellent=pect.excellent,
VeryGood=pect.verygood,
Good=pect.good,
Fair=pect.fair,
Poor=pect.poor,
TourEvaluation=colnames(datasummary2017%>% select(x)))}
eval.sum <-lapply(colnames(datasummary2017[,3:10]),Group.Evaluation)
eval.sum <-as.data.frame(do.call(rbind, eval.sum ))
#I wrote function to get how many "good" in a given data set, which will be group_by tour_operator or tour_name. Each operator would have ten rows. since there are 10 column in the original dataframe. The computer will go over each row to count how many "good" in that.
CalGood <-function (x){
data <-x
str_count(data,"Good")
}
CalVeryGood <-function (x){
data <-x
str_count(data,"Very Good")
}
CalExcellent <-function (x){
data <-x
str_count(data,"Excellent")
}
CalFair <-function (x){
data <-x
str_count(data,"Fair")
}
CalPoor <-function (x){
data <-x
str_count(data,"Poor")
}
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
datasum.name<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
datasum.name$Excellent <-paste(round(datasum.name$Excellent*100,2),"%",sep="")
View(datasum.name)
View(eval.sum)
library(dplyr)
library(ggplot2)
library(data.table)
library(stringr)
datasummary2017 <-read.csv("data/data2017_jan_oct.csv",stringsAsFactors = FALSE)
# I got the summary of how much percentage of each evaluation.
Group.Evaluation <-function (x) {
col_name <- as.name(colnames(datasummary2017 %>% select(x)))
group.eval <-datasummary2017 %>%
group_by_(col_name) %>%
summarise(n=n())
group.eval <-group.eval[complete.cases(group.eval), ]
total.number <-sum(group.eval$n)
pect.excellent <-paste(round(as.numeric(group.eval[group.eval[,1]=="Excellent",2])/total.number,4)*100, "%", sep="")
pect.good <-paste(round(as.numeric(group.eval[group.eval[,1]=="Good",2])/total.number,4)*100, "%", sep="")
pect.verygood <-paste(round(as.numeric(group.eval[group.eval[,1]=="Very Good",2])/total.number,4)*100, "%", sep="")
pect.fair <-paste(round(as.numeric(group.eval[group.eval[,1]=="Fair",2])/total.number,4)*100, "%", sep="")
pect.poor <-paste(round(as.numeric(group.eval[group.eval[,1]=="Poor",2])/total.number,4)*100, "%", sep="")
eval.data <- data.frame(
Excellent=pect.excellent,
VeryGood=pect.verygood,
Good=pect.good,
Fair=pect.fair,
Poor=pect.poor,
TourEvaluation=colnames(datasummary2017%>% select(x)))}
eval.sum <-lapply(colnames(datasummary2017[,3:10]),Group.Evaluation)
eval.sum <-as.data.frame(do.call(rbind, eval.sum ))
#I wrote function to get how many "good" in a given data set, which will be group_by tour_operator or tour_name. Each operator would have ten rows. since there are 10 column in the original dataframe. The computer will go over each row to count how many "good" in that.
CalGood <-function (x){
data <-x
str_count(data,"Good")
}
CalVeryGood <-function (x){
data <-x
str_count(data,"Very Good")
}
CalExcellent <-function (x){
data <-x
str_count(data,"Excellent")
}
CalFair <-function (x){
data <-x
str_count(data,"Fair")
}
CalPoor <-function (x){
data <-x
str_count(data,"Poor")
}
datasum.name <- datasummary2017 %>%
group_by(tour_name) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.)))
datasum.name[,"total"] <-rowSums(datasum.name[,c(2:6)])
name.eval<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
name.eval$Excellent <-paste(round(datasum.name$Excellent*100,2),"%",sep="")
name.eval$VeryGood <-paste(round(datasum.name$VeryGood*100,2),"%",sep="")
name.eval$Good <-paste(round(datasum.name$Good*100,2),"%",sep="")
name.eval$Fair <-paste(round(datasum.name$Fair*100,2),"%",sep="")
name.eval$Poor <-paste(round(datasum.name$Poor*100,2),"%",sep="")
name.eval<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"good"=sum(good)/Total,
"fair"=sum(fair)/Total,
"poor"=sum(poor)/Total)
View(name.eval)
name.eval$Excellent <-paste(round(name.eval$Excellent*100,2),"%",sep="")
name.eval$VeryGood <-paste(round(name.eval$VeryGood*100,2),"%",sep="")
name.eval$Good <-paste(round(name.eval$Good*100,2),"%",sep="")
name.eval$Fair <-paste(round(name.eval$Fair*100,2),"%",sep="")
name.eval$Poor <-paste(round(name.eval$Poor*100,2),"%",sep="")
name.eval<- datasum.name %>% group_by(tour_name) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"Good"=sum(good)/Total,
"Fair"=sum(fair)/Total,
"Poor"=sum(poor)/Total)
"Poor"=sum(poor)/Total)
name.eval$Excellent <-paste(round(name.eval$Excellent*100,2),"%",sep="")
name.eval$VeryGood <-paste(round(name.eval$VeryGood*100,2),"%",sep="")
name.eval$Good <-paste(round(name.eval$Good*100,2),"%",sep="")
name.eval$Fair <-paste(round(name.eval$Fair*100,2),"%",sep="")
name.eval$Poor <-paste(round(name.eval$Poor*100,2),"%",sep="")
View(name.eval)
datasum.operator <- datasummary2017 %>%
group_by(tour_operator) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
select("tour_operator","excellent","very_good","good","fair","poor")
datasum.operator[,"Total"] <-rowSums(datasum.operator[,c(2:6)])
operator.eval<- datasum.operator %>% group_by(tour_operator) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"Good"=sum(good)/Total,
"Fair"=sum(fair)/Total,
"Poor"=sum(poor)/Total)
datasum.operator <- datasummary2017 %>%
group_by(tour_operator) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
select("tour_operator","excellent","very_good","good","fair","poor")
datasum.operator[,"Total"] <-rowSums(datasum.operator[,c(2:6)])
View(datasum.operator)
datasum.operator <- datasummary2017 %>%
group_by(tour_operator) %>%
do(data.frame(excellent=CalExcellent(.),
very_good=CalVeryGood(.),
good=CalGood(.),
fair=CalFair(.),
poor=CalPoor(.))) %>%
select("tour_operator","excellent","very_good","good","fair","poor")
datasum.operator[,"total"] <-rowSums(datasum.operator[,c(2:6)])
operator.eval<- datasum.operator %>% group_by(tour_operator) %>% summarise("Total"=sum(total),
"Excellent"=sum(excellent)/Total,
"VeryGood"=sum(very_good)/Total,
"Good"=sum(good)/Total,
"Fair"=sum(fair)/Total,
"Poor"=sum(poor)/Total)
"Fair"=sum(fair)/Total,
"Poor"=sum(poor)/Total)
operator.eval$Excellent <-paste(round(operator.eval$Excellent*100,2),"%",sep="")
operator.eval$VeryGood <-paste(round(operator.eval$VeryGood*100,2),"%",sep="")
operator.eval$Good <-paste(round(operator.eval$Good*100,2),"%",sep="")
operator.eval$Fair <-paste(round(operator.eval$Fair*100,2),"%",sep="")
operator.eval$Poor <-paste(round(operator.eval$Poor*100,2),"%",sep="")
View(operator.eval)
